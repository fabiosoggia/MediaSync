/*! MediaSync 0.0.3 Copyright Â© 2014 Fabio Soggia - Released under the MIT Licence */
var MediaSync=function(a,b){this.media=a,this.moments=b.moments,this.moments.sort(function(a,b){return a.at-b.at}),this.minTime=this.moments[0].at,this.maxTime=this.moments[this.moments.length-1].at,this.callback=b.callback,this.once=b.once===!1?!1:!0,this.last=-1,this.update()};MediaSync.prototype.search=function(a){if(a<this.minTime)return-1;if(a>this.maxTime)return this.moments.length-1;for(var b,c,d,e=0,f=this.moments.length-1;f>=e;){if(b=(e+f)/2|0,c=this.moments[b],d=this.moments[b+1],a>=c.at&&a<d.at)return b;a>c.at?e=b+1:f=b-1}},MediaSync.prototype.update=function(){var a=0;this.media.getCurrentTime?a=this.media.getCurrentTime():console.log("Unable to call getCurrentTime on media");var b=this.search(a);-1!=b&&(this.last==b&&this.once||(this.last=b,this.callback(this.moments[b],a)));var c=this;requestAnimationFrame(function(){c.update.call(c)})};